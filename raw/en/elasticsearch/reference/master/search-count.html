<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Count API | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="search.html" title="Search APIs"/>
<link rel="prev" href="eql-search-api.html" title="EQL search API"/>
<link rel="next" href="search-validate.html" title="Validate API"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
»
<span class="breadcrumb-link"><a href="search.html">Search APIs</a></span>
»
<span class="breadcrumb-node">Count API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql-search-api.html">« EQL search API</a>
</span>
<span class="next">
<a href="search-validate.html">Validate API »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-count"></a>Count API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h2>
</div></div></div>
<p>Gets the number of matches for a search query.</p>
<div class="pre_wrapper lang-csharp alternative">
<pre class="programlisting prettyprint lang-csharp alternative">var countResponse = client.Count&lt;Tweet&gt;(c =&gt; c
    .Index("twitter")
    .QueryOnQueryString("user:kimchy")
);</pre>
</div>
<div class="pre_wrapper lang-python alternative">
<pre class="programlisting prettyprint lang-python alternative">resp = client.count(index="twitter", q="user:kimchy")
print(resp)</pre>
</div>
<div class="pre_wrapper lang-ruby alternative">
<pre class="programlisting prettyprint lang-ruby alternative">response = client.count(
  index: 'twitter',
  q: 'user:kimchy'
)
puts response</pre>
</div>
<div class="pre_wrapper lang-go alternative">
<pre class="programlisting prettyprint lang-go alternative">res, err := es.Count(
	es.Count.WithIndex("?q=user:kimchy"),
	es.Count.WithQuery("user:kimchy"),
	es.Count.WithPretty(),
)
fmt.Println(res, err)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<pre class="programlisting prettyprint lang-js alternative">const response = await client.count({
  index: 'twitter',
  q: 'user:kimchy'
})
console.log(response)</pre>
</div>
<a id="1b542e3ea87a742f95641d64dcfb1bdb"></a>
<div class="pre_wrapper lang-console default has-csharp has-python has-ruby has-go has-js">
<pre class="programlisting prettyprint lang-console default has-csharp has-python has-ruby has-go has-js">GET /twitter/_count?q=user:kimchy</pre>
</div>
<div class="console_widget has-csharp has-python has-ruby has-go has-js" data-snippet="snippets/2052.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The query being sent in the body must be nested in a <code class="literal">query</code> key, same as
the <a class="xref" href="search-search.html" title="Search API">search api</a> works.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /&lt;index&gt;/_count</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<p>The count API allows you to execute a query and get the number of matches for
that query. It can be executed across one or more indices. The query can either
be provided using a simple query string as a parameter, or using the
<a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a> defined within the request body.</p>
<p>The count API can be applied to <a class="xref" href="search-search.html#search-multi-index" title="Search several indices using the q query parameter">multiple indices</a>.</p>
<p>The operation is broadcast across all shards. For each shard id group, a replica
is chosen and executed against it. This means that replicas increase the
scalability of count.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
(Optional, string) Comma-separated list or wildcard expression of index names
used to limit the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_indices</code>
</span>
</dt>
<dd>
<p>
(Optional, boolean) If <code class="literal">true</code>,
the request does <span class="strong strong"><strong>not</strong></span> return an error
if a wildcard expression
or <code class="literal">_all</code> value retrieves only missing or closed indices.
</p>
<p>This parameter also applies to <a class="xref" href="indices-aliases.html" title="Update index alias API">index aliases</a>
that point to a missing or closed index.</p>
<p>Defaults to <code class="literal">true</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">analyzer</code>
</span>
</dt>
<dd>
(Optional, string) Analyzer to use for the query string.
</dd>
<dt>
<span class="term">
<code class="literal">analyze_wildcard</code>
</span>
</dt>
<dd>
(Optional, boolean) If <code class="literal">true</code>, wildcard and prefix queries are
analyzed. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">default_operator</code>
</span>
</dt>
<dd>
(Optional, string) The default operator for query string query: AND or OR.
Defaults to <code class="literal">OR</code>.
</dd>
<dt>
<span class="term">
<code class="literal">df</code>
</span>
</dt>
<dd>
(Optional, string) Field to use as default where no field prefix is
given in the query string.
</dd>
<dt>
<span class="term">
<code class="literal">expand_wildcards</code>
</span>
</dt>
<dd>
<p>(Optional, string) Controls what kind of indices that wildcard expressions can
expand to. Multiple values are accepted when separated by a comma, as in
<code class="literal">open,hidden</code>. Valid values are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">all</code>
</span>
</dt>
<dd>
Expand to open and closed indices, including <a class="xref" href="index-modules.html#index-hidden">hidden indices</a>.
</dd>
<dt>
<span class="term">
<code class="literal">open</code>
</span>
</dt>
<dd>
Expand only to open indices.
</dd>
<dt>
<span class="term">
<code class="literal">closed</code>
</span>
</dt>
<dd>
Expand only to closed indices.
</dd>
<dt>
<span class="term">
<code class="literal">hidden</code>
</span>
</dt>
<dd>
Expansion of wildcards will include <a class="xref" href="index-modules.html#index-hidden">hidden indices</a>.
Must be combined with <code class="literal">open</code>, <code class="literal">closed</code>, or both.
</dd>
<dt>
<span class="term">
<code class="literal">none</code>
</span>
</dt>
<dd>
Wildcard expressions are not accepted.
</dd>
</dl>
</div>
<p>Defaults to <code class="literal">open</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_throttled</code>
</span>
</dt>
<dd>
(Optional, boolean) If <code class="literal">true</code>, concrete, expanded or aliased indices are
ignored when frozen.
</dd>
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
(Optional, boolean) If <code class="literal">true</code>, missing or closed indices are not included in the
response. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">lenient</code>
</span>
</dt>
<dd>
(Optional, boolean) If <code class="literal">true</code>, format-based query failures (such as
providing text to a numeric field) will be ignored. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">min_score</code>
</span>
</dt>
<dd>
(Optional, float)
  Sets the minimum <code class="literal">_score</code> value that documents must have to be included in the
  result.
</dd>
<dt>
<span class="term">
<code class="literal">preference</code>
</span>
</dt>
<dd>
(Optional, string) Specifies the node or shard the operation should be
performed on. Random by default.
</dd>
<dt>
<span class="term">
<code class="literal">q</code>
</span>
</dt>
<dd>
(Optional, string) Query in the Lucene query string syntax.
</dd>
<dt>
<span class="term">
<code class="literal">routing</code>
</span>
</dt>
<dd>
(Optional, string) Target the specified primary shard.
</dd>
<dt>
<span class="term">
<code class="literal">terminate_after</code>
</span>
</dt>
<dd>
(Optional, integer) The maximum number of documents to collect for each shard,
upon reaching which the query execution will terminate early.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="query-dsl.html" title="Query DSL">query object</a>) Defines the search definition using the
<a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-count-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/search/count.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp alternative">
<pre class="programlisting prettyprint lang-csharp alternative">var indexResponse = client.Index(new Tweet
{
    User = "kimchy"
}, i =&gt; i.Id(1).Index("twitter").Refresh(Refresh.True));

var countResponse1 = client.Count&lt;Tweet&gt;(c =&gt; c
    .Index("twitter")
    .QueryOnQueryString("user:kimchy")
);

var countResponse2 = client.Count&lt;Tweet&gt;(c =&gt; c
    .Index("twitter")
    .Query(q =&gt; q
        .Term("user", "kimchy")
    )
);</pre>
</div>
<div class="pre_wrapper lang-python alternative">
<pre class="programlisting prettyprint lang-python alternative">resp = client.index(
    index="twitter", id="1", refresh=True, body={"user": "kimchy"},
)
print(resp)

resp = client.count(index="twitter", q="user:kimchy")
print(resp)

resp = client.count(
    index="twitter", body={"query": {"term": {"user": "kimchy"}}},
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-ruby alternative">
<pre class="programlisting prettyprint lang-ruby alternative">response = client.index(
  index: 'twitter',
  id: 1,
  refresh: true,
  body: {
    user: 'kimchy'
  }
)
puts response

response = client.index(
  index: 'twitter',
  q: 'user:kimchy'
)
puts response

response = client.index(
  index: 'twitter',
  body: {
    query: {
      term: {
        user: 'kimchy'
      }
    }
  }
)
puts response</pre>
</div>
<div class="pre_wrapper lang-go alternative">
<pre class="programlisting prettyprint lang-go alternative">{
	res, err := es.Index(
		"twitter",
		strings.NewReader(`{
	  "user": "kimchy"
	}`),
		es.Index.WithDocumentID("1"),
		es.Index.WithRefresh("true"),
		es.Index.WithPretty(),
	)
	fmt.Println(res, err)
}

{
	res, err := es.Count(
		es.Count.WithIndex("?q=user:kimchy"),
		es.Count.WithQuery("user:kimchy"),
		es.Count.WithPretty(),
	)
	fmt.Println(res, err)
}

{
	res, err := es.Count(
		es.Count.WithIndex(""),
		es.Count.WithBody(strings.NewReader(`{
	  "query": {
	    "term": {
	      "user": "kimchy"
	    }
	  }
	}`)),
		es.Count.WithPretty(),
	)
	fmt.Println(res, err)
}</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<pre class="programlisting prettyprint lang-js alternative">const response0 = await client.index({
  index: 'twitter',
  id: '1',
  refresh: true,
  body: {
    user: 'kimchy'
  }
})
console.log(response0)

const response1 = await client.count({
  index: 'twitter',
  q: 'user:kimchy'
})
console.log(response1)

const response2 = await client.count({
  index: 'twitter',
  body: {
    query: {
      term: {
        user: 'kimchy'
      }
    }
  }
})
console.log(response2)</pre>
</div>
<a id="8f0511f8a5cb176ff2afdd4311799a33"></a>
<div class="pre_wrapper lang-console default has-csharp has-python has-ruby has-go has-js">
<pre class="programlisting prettyprint lang-console default has-csharp has-python has-ruby has-go has-js">PUT /twitter/_doc/1?refresh
{
    "user": "kimchy"
}

GET /twitter/_count?q=user:kimchy

GET /twitter/_count
{
    "query" : {
        "term" : { "user" : "kimchy" }
    }
}</pre>
</div>
<div class="console_widget has-csharp has-python has-ruby has-go has-js" data-snippet="snippets/2053.console"></div>
<p>Both examples above do the same: count the number of tweets from the <code class="literal">twitter</code>
index for a certain user. The API returns the following response:</p>
<a id="ff7c62cdac9ce9ba27890ff93c28e805"></a>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
    "count" : 1,
    "_shards" : {
        "total" : 1,
        "successful" : 1,
        "skipped" : 0,
        "failed" : 0
    }
}</pre>
</div>
<p>The query is optional, and when not provided, it will use <code class="literal">match_all</code> to
count all the docs.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="eql-search-api.html">« EQL search API</a>
</span>
<span class="next">
<a href="search-validate.html">Validate API »</a>
</span>
</div>
</div>
</body>
</html>
