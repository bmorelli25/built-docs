<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>NetFlow module
        | Filebeat Reference [7.4]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Filebeat Reference [7.4]" /><link rel="up" href="filebeat-modules.html" title="Modules" /><link rel="prev" href="filebeat-module-nats.html" title="nats module" /><link rel="next" href="filebeat-module-nginx.html" title="Nginx module" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Filebeat/Reference/7.4" /><meta name="DC.subject" content="Filebeat" /><meta name="DC.identifier" content="7.4" /></head><body><div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Filebeat Reference
      [7.4]
    </a></span> » <span class="breadcrumb-link"><a href="filebeat-modules.html">Modules</a></span> » <span class="breadcrumb-node">NetFlow module</span></div><div class="navheader"><span class="prev"><a href="filebeat-module-nats.html">
              « 
              nats module</a>
           
        </span><span class="next">
           
          <a href="filebeat-module-nginx.html">Nginx module
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="filebeat-module-netflow"></a>NetFlow module<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/modules/netflow.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>This is a module for receiving NetFlow and IPFIX flow records over UDP. This
input supports NetFlow versions 1, 5, 6, 7, 8 and 9, as well as IPFIX. For
NetFlow versions older than 9, fields are mapped automatically to NetFlow v9.</p><p>This module wraps the <a class="link" href="filebeat-input-netflow.html" title="NetFlow input">netflow input</a> to enrich the
flow records with geolocation information about the IP endpoints by using
Elasticsearch Ingest Node.</p><h3><a id="running-netflow-modules"></a>Set up and run the module<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/include/running-modules.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Before doing these steps, verify that Elasticsearch and Kibana are running and
that Elasticsearch is ready to receive data from Filebeat.</p><p>If you’re running our
<a class="ulink" href="https://www.elastic.co/cloud/elasticsearch-service" target="_top">hosted Elasticsearch Service</a> on
Elastic Cloud, or you’ve enabled security in Elasticsearch and Kibana, you need to specify
additional connection information before setting up and running the module. See
<a class="xref" href="filebeat-modules-quickstart.html" title="Quick start: modules for common log formats">Quick start: modules for common log formats</a> for the complete setup.</p><p>To set up and run the module:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Enable the module:
</p><p class="simpara"><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat modules enable netflow</pre></div><p class="simpara"><span class="strong strong"><strong>mac:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat modules enable netflow</pre></div><p class="simpara"><span class="strong strong"><strong>brew:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat modules enable netflow</pre></div><p class="simpara"><span class="strong strong"><strong>linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat modules enable netflow</pre></div><p class="simpara"><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\filebeat.exe modules enable netflow</pre></div><p class="simpara">This command enables the module config defined in the <code class="literal">modules.d</code> directory. See
<a class="xref" href="configuration-filebeat-modules.html" title="Specify which modules to run"><em>Specify which modules to run</em></a> for other ways to enable modules.</p><p class="simpara">To see a list of enabled and disabled modules, run:</p><p class="simpara"><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat modules list</pre></div><p class="simpara"><span class="strong strong"><strong>mac:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat modules list</pre></div><p class="simpara"><span class="strong strong"><strong>brew:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat modules list</pre></div><p class="simpara"><span class="strong strong"><strong>linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat modules list</pre></div><p class="simpara"><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\filebeat.exe modules list</pre></div></li><li class="listitem"><p class="simpara">
Set up the initial environment:
</p><p class="simpara"><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat setup -e</pre></div><p class="simpara"><span class="strong strong"><strong>mac:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat setup -e</pre></div><p class="simpara"><span class="strong strong"><strong>linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat setup -e</pre></div><p class="simpara"><span class="strong strong"><strong>brew:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat setup -e</pre></div><p class="simpara"><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\filebeat.exe setup -e</pre></div><p class="simpara">The <a class="link" href="command-line-options.html#setup-command" title="setup command"><code class="literal">setup</code></a> command loads the recommended index template for
writing to Elasticsearch and deploys the sample dashboards (if available) for visualizing
the data in Kibana. This is a one-time setup step.</p><p class="simpara">The <code class="literal">-e</code> flag is optional and sends output to standard error instead of syslog.</p><p class="simpara">The ingest pipelines used to parse log lines are set up automatically the first
time you run the module, assuming the Elasticsearch output is enabled. If you’re sending
events to Logstash, or plan to use <a class="link" href="configuration-central-management.html" title="Beats central management">Beats central management</a>, also see <a class="xref" href="filebeat-modules-quickstart.html#load-ingest-pipelines" title="Load ingest pipelines manually">Load ingest pipelines manually</a>.</p></li><li class="listitem"><p class="simpara">
Run Filebeat.
</p><p class="simpara">If your logs aren’t in the default location, see
<a class="xref" href="filebeat-module-netflow.html#configuring-netflow-module" title="Configure the module">Configure the module</a>, then run Filebeat after you’ve
set the paths variable.</p><p class="simpara"><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">service filebeat start</pre></div><p class="simpara"><span class="strong strong"><strong>mac:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat -e</pre></div><p class="simpara"><span class="strong strong"><strong>brew:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">filebeat -e</pre></div><p class="simpara"><span class="strong strong"><strong>linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./filebeat -e</pre></div><p class="simpara"><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; Start-Service filebeat</pre></div><p class="simpara">If the module is configured correctly, you’ll see
<code class="literal">INFO Harvester started</code> messages for each file specified in the config.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Depending on how you’ve installed Filebeat, you might see errors
related to file ownership or permissions when you try to run Filebeat
modules. See <a class="ulink" href="https://www.elastic.co/guide/en/beats/libbeat/7.4/config-file-permissions.html" target="_top">Config File Ownership and
Permissions</a> in the <span class="emphasis"><em>Beats Platform Reference</em></span> for more information.</p></div></div></li></ol></div><h3><a id="configuring-netflow-module"></a>Configure the module<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/include/configuring-intro.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can further refine the behavior of the <code class="literal">netflow</code> module by specifying
<a class="link" href="filebeat-module-netflow.html#netflow-settings" title="Variable settings">variable settings</a> in the
<code class="literal">modules.d/netflow.yml</code> file, or overriding settings at the command line.</p><h4><a id="netflow-settings"></a>Variable settings<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/include/config-option-intro.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Each fileset has separate variable settings for configuring the behavior of the
module. If you don’t specify variable settings, the <code class="literal">netflow</code> module uses
the defaults.</p><p>For more information, see <a class="xref" href="specify-variable-settings.html" title="Specify variable settings">Specify variable settings</a>. Also see
<a class="xref" href="advanced-settings.html" title="Advanced settings">Advanced settings</a>.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>When you specify a setting at the command line, remember to prefix the
setting with the module name, for example, <code class="literal">netflow.log.var.paths</code>
instead of <code class="literal">log.var.paths</code>.</p></div></div><h4><a id="_literal_log_literal_fileset_settings_8"></a><code class="literal">log</code> fileset settings<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/modules/netflow.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The fileset is by default configured to listen for UDP traffic on
<code class="literal">localhost:2055</code>. For most uses cases you will want to set the <code class="literal">netflow_host</code>
variable to allow the input bind to all interfaces so that it can receive
traffic from network devices.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">- module: netflow
  log:
    enabled: true
    var:
      netflow_host: 0.0.0.0
      netflow_port: 2055</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">var.netflow_host</code>
</span></dt><dd>
Address to find to. Defaults to <code class="literal">localhost</code>.
</dd><dt><span class="term">
<code class="literal">var.netflow_port</code>
</span></dt><dd>
Port to listen on. Defaults to <code class="literal">2055</code>.
</dd><dt><span class="term">
<code class="literal">var.max_message_size</code>
</span></dt><dd>
The maximum size of the message received over UDP.
The default is <code class="literal">10KiB</code>.
</dd><dt><span class="term">
<code class="literal">var.expiration_timeout</code>
</span></dt><dd>
The time before an idle session or unused template is
expired. Only applicable to v9 and IPFIX protocols. A value of zero disables
expiration.
</dd><dt><span class="term">
<code class="literal">var.queue_size</code>
</span></dt><dd>
The maximum number of packets that can be queued for
processing. Use this setting to avoid packet-loss when dealing with occasional
bursts of traffic.
</dd></dl></div><h3><a id="_fields_22"></a>Fields<a href="https://github.com/elastic/beats/edit/7.4/filebeat/docs/modules/netflow.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>For a description of each field in the module, see the
<a class="link" href="exported-fields-netflow.html" title="NetFlow fields">exported fields</a> section.</p></div><div class="navfooter"><span class="prev"><a href="filebeat-module-nats.html">
              « 
              nats module</a>
           
        </span><span class="next">
           
          <a href="filebeat-module-nginx.html">Nginx module
               »
            </a></span></div></body></html>
