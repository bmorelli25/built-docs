<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Step 2: Configure Functionbeat
        | Functionbeat Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Functionbeat Reference [master]" /><link rel="up" href="functionbeat-getting-started.html" title="Getting Started With Functionbeat" /><link rel="prev" href="functionbeat-installation.html" title="Step 1: Download the Functionbeat package" /><link rel="next" href="functionbeat-template.html" title="Step 3: Load the index template in Elasticsearch" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Functionbeat/Reference/master" /><meta name="DC.subject" content="Functionbeat" /><meta name="DC.identifier" content="master" /></head><body><div class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Functionbeat Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="functionbeat-getting-started.html">Getting Started With Functionbeat</a></span> » <span class="breadcrumb-node">Step 2: Configure Functionbeat</span></div><div class="navheader"><span class="prev"><a href="functionbeat-installation.html">
              « 
              Step 1: Download the Functionbeat package</a>
           
        </span><span class="next">
           
          <a href="functionbeat-template.html">Step 3: Load the index template in Elasticsearch
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="functionbeat-configuration"></a>Step 2: Configure Functionbeat<a href="https://github.com/elastic/beats/edit/master/x-pack/functionbeat/docs/getting-started.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>Before deploying Functionbeat to your serverless environment, you need to
specify details about the functions that you want to deploy, including the
function name, type, and triggers that will cause the function to execute.
You also need to specify connection details for your Elasticsearch cluster.</p><p>You specify settings in the  <code class="literal">functionbeat.yml</code> configuration file. This file
is located in the archive that you extracted earlier.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>See the
<a class="ulink" href="https://www.elastic.co/guide/en/beats/libbeat/master/config-file-format.html" target="_top">Config File Format</a> section of the
<span class="emphasis"><em>Beats Platform Reference</em></span> for more about the structure of the config file.</p></div></div><p>The following example configures a function called <code class="literal">cloudwatch</code> that collects
events from CloudWatch Logs and forwards the events to Elasticsearch.</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">functionbeat.provider.aws.endpoint: "s3.amazonaws.com"
functionbeat.provider.aws.deploy_bucket: "functionbeat-deploy"
functionbeat.provider.aws.functions:
  - name: cloudwatch
    enabled: true
    type: cloudwatch_logs
    description: "lambda function for cloudwatch logs"
    triggers:
      - log_group_name: /aws/lambda/my-lambda-function
output.elasticsearch:
  cloud.id: "MyESDeployment:SomeLongString=="
  cloud.auth: "elastic:SomeLongString"</pre></div><p>To configure Functionbeat:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Specify a unique name for the S3 bucket to which the functions will be
uploaded. For example:
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">functionbeat.provider.aws.deploy_bucket: "functionbeat-deploy"</pre></div></li><li class="listitem"><p class="simpara">
Define the functions that you want to deploy. For each function, you must
specify:
</p><div class="informaltable"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<code class="literal">name</code>
</p>
</td><td valign="top">
<p>
A unique name for the Lambda function.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">type</code>
</p>
</td><td valign="top">
<p>
The type of service to monitor. For this release, the supported types
are:
</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">cloudwatch_logs</code> to collect data from CloudWatch logs
</li><li class="listitem">
<code class="literal">sqs</code> to collect messages from Amazon Simple Queue Service (SQS)
</li><li class="listitem">
<code class="literal">kinesis</code> to collect data from Kinesis data streams
</li></ul></div>
</td></tr><tr><td valign="top">
<p>
<code class="literal">triggers</code>
</p>
</td><td valign="top">
<p>
The triggers that will cause the function to execute. If <code class="literal">type</code>
is <code class="literal">cloudwatch_logs</code> logs, specify a list of log groups. If <code class="literal">type</code> is <code class="literal">sqs</code> or
<code class="literal">kinesis</code>, specify a list of Amazon Resource Names (ARNs).
</p>
<p>When a message is sent to the specified log group or queue, the Lambda function
executes and sends message events to the output configured for Functionbeat.</p>
<p>The following example configures a function called <code class="literal">sqs</code> that collects data
from Amazon SQS:</p>
<div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">- name: sqs
  enabled: true
  type: sqs
  triggers:
    - event_source_arn: arn:aws:sqs:us-east-1:123456789012:myevents</pre></div>
</td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
Configure the  Elasticsearch output by setting the location of the Elasticsearch installation:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
If you’re running our
<a class="ulink" href="https://www.elastic.co/cloud/elasticsearch-service" target="_top">hosted Elasticsearch Service</a>
on Elastic Cloud, specify your <a class="link" href="configure-cloud-id.html" title="Configure the output for the Elastic Cloud">Cloud ID</a>. For example:
</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">cloud.id: "staging:dXMtZWFzdC0xLmF3cy5mb3VuZC5pbyRjZWM2ZjI2MWE3NGJmMjRjZTMzYmI4ODExYjg0Mjk0ZiRjNmMyY2E2ZDA0MjI0OWFmMGNjN2Q3YTllOTYyNTc0Mw=="</pre></div></li><li class="listitem"><p class="simpara">
If you’re running Elasticsearch on your own hardware, set the host and port where
Functionbeat can find the Elasticsearch installation. For example:
</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["myEShost:9200"]</pre></div><p class="simpara">Elasticsearch is currently the only output supported by Functionbeat.</p></li></ul></div></li><li class="listitem"><p class="simpara">
If Elasticsearch and Kibana are secured, set credentials in the <code class="literal">functionbeat.yml</code> config
file before you run the commands that set up and start Functionbeat.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
If you’re running our
<a class="ulink" href="https://www.elastic.co/cloud/elasticsearch-service" target="_top">hosted Elasticsearch Service</a>
on Elastic Cloud, specify your <a class="link" href="configure-cloud-id.html" title="Configure the output for the Elastic Cloud">cloud auth</a> credentials.
For example:
</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">cloud.auth: "elastic:YOUR_PASSWORD"</pre></div></li><li class="listitem"><p class="simpara">
If you’re running Elasticsearch on your own hardware, specify your Elasticsearch and Kibana
credentials:
</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["myEShost:9200"]
  username: "filebeat_internal"
  password: "YOUR_PASSWORD" <a id="CO1-1"></a><i class="conum" data-value="1"></i>
setup.kibana:
  host: "mykibanahost:5601"
  username: "my_kibana_user" <a id="CO1-2"></a><i class="conum" data-value="2"></i> <a id="CO1-3"></a><i class="conum" data-value="3"></i>
  password: "YOUR_PASSWORD"</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO1-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
This examples shows a hard-coded password, but you should store sensitive
values in the <a class="link" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO1-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">username</code> and <code class="literal">password</code> settings for Kibana are optional. If you don’t
specify credentials for Kibana, Functionbeat uses the <code class="literal">username</code> and <code class="literal">password</code>
specified for the Elasticsearch output.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO1-3"><i class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>
To use the pre-built Kibana dashboards, this user must have the
<code class="literal">kibana_user</code> <a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/master/built-in-roles.html" target="_top">built-in role</a> or equivalent
privileges.
</p><p>For more information, see <a class="xref" href="securing-functionbeat.html" title="Securing Functionbeat">Securing Functionbeat</a>.</p></td></tr></table></div></li></ul></div></li></ol></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>To test your configuration file, change to the directory where the
Functionbeat binary is installed, and run Functionbeat in the foreground with
the following options specified: <code class="literal">./functionbeat test config -e</code>. Make sure your
config files are in the path expected by Functionbeat (see <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a>),
or use the <code class="literal">-c</code> flag to specify the path to the config file.</p></div></div><p>Before starting Functionbeat, you should look at the configuration options in the
configuration file. For more information about these options, see <a class="xref" href="configuring-howto-functionbeat.html" title="Configuring Functionbeat">Configuring Functionbeat</a>.</p></div><div class="navfooter"><span class="prev"><a href="functionbeat-installation.html">
              « 
              Step 1: Download the Functionbeat package</a>
           
        </span><span class="next">
           
          <a href="functionbeat-template.html">Step 3: Load the index template in Elasticsearch
               »
            </a></span></div></body></html>
