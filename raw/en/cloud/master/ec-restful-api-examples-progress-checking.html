<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Applying a new plan: Checking on progress
        | Elasticsearch Service Documentation [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Service Documentation [master]" /><link rel="up" href="ec-restful-api-examples.html" title="API examples" /><link rel="prev" href="ec-restful-api-examples-resize-and-ha.html" title="Applying a new plan: Resize and add high availability" /><link rel="next" href="ec-restful-api-examples-upgrade.html" title="Applying a new deployment configuration: Upgrade" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Cloud/Reference/master" /><meta name="DC.subject" content="Elastic Cloud" /><meta name="DC.identifier" content="master" /></head><body><div class="page_header">You are looking at the future. Not what you want? See the <a href="https://www.elastic.co/guide/en/cloud/current/index.html">current release documentation</a>.</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="ec-restful-api.html">RESTful API</a></span> » <span class="breadcrumb-link"><a href="ec-restful-api-examples.html">API examples</a></span> » <span class="breadcrumb-node">Applying a new plan: Checking on progress</span></div><div class="navheader"><span class="prev"><a href="ec-restful-api-examples-resize-and-ha.html">
              « 
              Applying a new plan: Resize and add high availability</a>
           
        </span><span class="next">
           
          <a href="ec-restful-api-examples-upgrade.html">Applying a new deployment configuration: Upgrade
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="ec-restful-api-examples-progress-checking"></a>Applying a new plan: Checking on progress</h2></div></div></div><p>Applying a plan change means changing the configuration of a deployment. For smaller deployments, plan changes might take only a minute, but larger deployments might take quite a while, especially if data needs to be migrated to new nodes.</p><p>Switching to the Cloud UI to check on progress is not feasible if you plan to use the RESTful API for automation, so the API also lets you check on the progress of pending plan changes:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">curl -X GET -u $USER<a id="CO20-7"></a><i class="conum" data-value="1"></i>:$PASSWORD<a id="CO20-8"></a><i class="conum" data-value="2"></i> https://$CLUSTER_ID<a id="CO20-9"></a><i class="conum" data-value="3"></i>.REGION<a id="CO20-10"></a><i class="conum" data-value="4"></i>.PLATFORM<a id="CO20-11"></a><i class="conum" data-value="5"></i>.DOMAIN<a id="CO20-12"></a><i class="conum" data-value="6"></i>:9243
/api/v1/clusters/elasticsearch/$ELASTICSEARCH_CLUSTER_ID<a id="CO20-13"></a><i class="conum" data-value="7"></i>/plan/pending
{
  "zone_count": 3,
  "cluster_topology": [{
    "node_type": {

      },
    "memory_per_node": 4096,
    "node_count_per_zone": 1,
    "node_configuration": "default"
  }],
  "elasticsearch": {
    "version": "6.5.4",
    "system_settings": {
      "use_disk_threshold": true
    }
  },
  "deployment_template": {
    "id": "default"
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-1"><i class="conum" data-value="1"></i></a> <a href="#CO20-7"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
A user with sufficient privileges
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-2"><i class="conum" data-value="2"></i></a> <a href="#CO20-8"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The password for the user
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-3"><i class="conum" data-value="3"></i></a> <a href="#CO20-9"><i class="conum" data-value="3"></i></a> </p></td><td valign="top" align="left"><p>
The cluster ID that is unique to your cluster
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-4"><i class="conum" data-value="4"></i></a> <a href="#CO20-10"><i class="conum" data-value="4"></i></a> </p></td><td valign="top" align="left"><p>
The geographic region within your cloud platform. For example, <code class="literal">us-east-1</code> or <code class="literal">us-central1</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-5"><i class="conum" data-value="5"></i></a> <a href="#CO20-11"><i class="conum" data-value="5"></i></a> </p></td><td valign="top" align="left"><p>
The cloud platform, either <code class="literal">aws</code> for Amazon Web Services or <code class="literal">gcp</code> for Google Cloud Platform
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-6"><i class="conum" data-value="6"></i></a> <a href="#CO20-12"><i class="conum" data-value="6"></i></a> </p></td><td valign="top" align="left"><p>
The domain name. For example, <code class="literal">cloud.es.io</code> or <code class="literal">found.io</code>
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-13"><i class="conum" data-value="7"></i></a> </p></td><td valign="top" align="left"><p>
The Elasticsearch cluster ID as shown in the <a class="ulink" href="https://cloud.elastic.co/" target="_top">Elasticsearch Service Console</a> or obtained via the API
</p></td></tr></table></div><p>The JSON with the cluster configuration that gets returned is the plan that is currently pending, in this case the plan from <a class="link" href="ec-restful-api-examples-resize-and-ha.html" title="Applying a new plan: Resize and add high availability">our previous example</a>. After the configuration change has been completed, there will no longer be a pending plan and the same call will return an error (if you also specify <code class="literal">-v</code> with curl the error code returned is <code class="literal">412 Precondition Failed</code>):</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">curl -X GET -u $USER<a id="CO21-1"></a><i class="conum" data-value="1"></i>:$PASSWORD<a id="CO21-2"></a><i class="conum" data-value="2"></i> https://$CLUSTER_ID<a id="CO21-3"></a><i class="conum" data-value="3"></i>.REGION<a id="CO21-4"></a><i class="conum" data-value="4"></i>.PLATFORM<a id="CO21-5"></a><i class="conum" data-value="5"></i>.DOMAIN<a id="CO21-6"></a><i class="conum" data-value="6"></i>:9243
/api/v1/clusters/elasticsearch/$ELASTICSEARCH_CLUSTER_ID/plan/pending
{
  "errors": [{
    "code": "clusters.cluster_plan_state_error",
    "message": "This cluster ([ELASTICSEARCH_CLUSTER_ID]) has no pending plan active"
  }]
}</pre></div><p>For long-running changes that might involve large clusters, this "yes" or "no" answer to the question whether there are still pending configuration changes might not always be sufficiently granular. If you need more detailed information, you can also get the activity log returned back to you:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">curl -X GET -u $USER:$PASSWORD https://$CLUSTER_ID.$REGION.$PLATFORM.$DOMAIN:9243
/api/v1/clusters/elasticsearch/$ELASTICSEARCH_CLUSTER_ID/plan/activity?show_plan_logs=true</pre></div><p>Beware that the activity log can be quite long, as it lists every step in the deployment configuration process. To simplify the output, you can grep on <code class="literal">"message": "Completed step:</code> to get the highlights of how each step in the plan is getting applied. The output will look similar to this very abridged example:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">"message": "Starting step: [plan-validator]: [cluster=ElasticsearchCluster(1e5675defe924b14af39136bd476fe36), stat=4294980506,4294980506,1544207967588,1544207967588,0,0,0,0,1403,0,4294980506\n]"
...
"message": "Plan successfully constructed: [PlanSuccessful()]"</pre></div></div><div class="navfooter"><span class="prev"><a href="ec-restful-api-examples-resize-and-ha.html">
              « 
              Applying a new plan: Resize and add high availability</a>
           
        </span><span class="next">
           
          <a href="ec-restful-api-examples-upgrade.html">Applying a new deployment configuration: Upgrade
               »
            </a></span></div></body></html>
