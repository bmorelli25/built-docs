<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Deployment CRUD operations | Elasticsearch Service Documentation [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Service Documentation [master]"/>
<link rel="up" href="ec-api-examples.html" title="API examples"/>
<link rel="prev" href="ec-api-examples.html" title="API examples"/>
<link rel="next" href="ec-api-deployment-other.html" title="Other deployment operations"/>
<meta name="DC.type" content="Learn/Docs/Cloud/Reference/master"/>
<meta name="DC.subject" content="Elastic Cloud"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation [master]</a></span>
»
<span class="breadcrumb-link"><a href="ec-restful-api.html">RESTful API</a></span>
»
<span class="breadcrumb-link"><a href="ec-api-examples.html">API examples</a></span>
»
<span class="breadcrumb-node">Deployment CRUD operations</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ec-api-examples.html">« API examples</a>
</span>
<span class="next">
<a href="ec-api-deployment-other.html">Other deployment operations »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ec-api-deployment-crud"></a>Deployment CRUD operations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h2>
</div></div></div>
<p>The following examples demonstrate Create, Read, Update and Delete operations on a <code class="literal">deployments</code> resource.</p>
<h4><a id="ec_listing_your_deployments"></a>Listing your deployments<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h4>
<p>List the details about all of your Elasticsearch Service deployments.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl \
-H "Authorization: ApiKey $EC_API_KEY" \
https://api.elastic-cloud.com/api/v1/deployments</pre>
</div>
<h4><a id="ec_getting_details_about_a_particular_deployment"></a>Getting details about a particular deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h4>
<p>List the details about a particular deployment identified by <code class="literal">id</code>.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/deployments/$DEPLOYMENT_ID"</pre>
</div>
<h4><a id="ec_using_the_api_to_create_your_first_deployment"></a>Using the API to create your first deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h4>
<p>The API request to create a new deployment is very descriptive, with many settings to tweak.
To make things easier, you can use this API endpoint to fetch a list of the deployment templates.</p>
<h5><a id="ec_get_the_templates"></a>Get the templates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl \
-H "Authorization: ApiKey $EC_API_KEY" \
https://api.elastic-cloud.com/api/v1/regions/$REGION_ID/platform/configuration/templates/deployments</pre>
</div>
<p>The <code class="literal">description</code> attribute helps you to determine which template you want to base your deployment on. After selecting a deployment, tune the <code class="literal">memory</code> size <code class="literal">value</code> and <code class="literal">zone</code> count to further customize the deployment.</p>
<h5><a id="ec_create_a_deployment"></a>Create a deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h5>
<p>This example creates a new deployment with the following characteristics:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Version <code class="literal">7.4.2</code> of the Elastic Stack
</li>
<li class="listitem">
Elasticsearch cluster in two zones with 8 GB of memory for each node
</li>
<li class="listitem">
1 GB single zone Kibana instance and a 512 MB APM instance
</li>
</ul>
</div>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl -XPOST \
-H 'content-type:application/json' \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/deployments" \
-d '
{
  "name": "my-first-api-deployment",
  "resources": {
    "elasticsearch": [
      {
        "region": "us-east-1",
        "ref_id": "main-elasticsearch",
        "plan": {
          "cluster_topology": [
            {
              "node_type": {
                "data": true,
                "master": true,
                "ingest": true
              },
              "instance_configuration_id": "aws.data.highio.i3",
              "zone_count": 2, <a id="CO16-1"></a><i class="conum" data-value="1"></i>
              "size": {
                "resource": "memory",
                "value": 8192<a id="CO16-2"></a><i class="conum" data-value="2"></i>
              },
              "elasticsearch": {
                "enabled_built_in_plugins": []
              }
            }
          ],
          "elasticsearch": {
            "version": "7.4.2"
          },
          "deployment_template": {
            "id": "aws-io-optimized"
          }
        },
        "settings": {
          "dedicated_masters_threshold": 6
        }
      }
    ],
    "kibana": [
      {
        "region": "us-east-1",
        "elasticsearch_cluster_ref_id": "main-elasticsearch",
        "ref_id": "main-kibana",
        "plan": {
          "cluster_topology": [
            {
              "instance_configuration_id": "aws.kibana.r4",
              "zone_count": 1, <a id="CO16-3"></a><i class="conum" data-value="3"></i>
              "size": {
                "resource": "memory",
                "value": 1024<a id="CO16-4"></a><i class="conum" data-value="4"></i>
              }
            }
          ],
          "kibana": {
            "version": "7.4.2"
          }
        }
      }
    ],
    "apm": [
      {
        "region": "us-east-1",
        "elasticsearch_cluster_ref_id": "main-elasticsearch",
        "ref_id": "main-apm",
        "plan": {
          "apm": {
            "version": "7.4.2"
          },
          "cluster_topology": [
            {
              "instance_configuration_id": "aws.apm.r4",
              "zone_count": 1, <a id="CO16-5"></a><i class="conum" data-value="5"></i>
              "size": {
                "value": 512, <a id="CO16-6"></a><i class="conum" data-value="6"></i>
                "resource": "memory"
              }
            }
          ]
        }
      }
    ]
  }
}
'</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of availability zones for the Elasticsearch cluster</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The amount of memory allocated for each Elasticsearch node</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of availability zones for Kibana</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The amount of memory allocated for Kibana</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of availability zones for APM</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>The amount of memory allocated for APM</p>
</td>
</tr>
</table>
</div>
<h4><a id="ec_update_a_deployment"></a>Update a deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h4>
<p>Modify the Elasticsearch resource by increasing the amount of memory to 15 GB.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl -XPUT \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/deployments/$DEPLOYMENT_ID" \
-d '
{
  "name": "my-first-api-deployment-with-new-name", <a id="CO17-1"></a><i class="conum" data-value="1"></i>
  "prune_orphans": false,
  "resources": {
    "elasticsearch": [
      {
        "region": "us-east-1",
        "ref_id": "main-elasticsearch",
        "plan": {
          "cluster_topology": [
            {
              "instance_configuration_id": "aws.data.highio.i3",
              "node_type": {
                "data": true,
                "ingest": true,
                "master": true
              },
              "zone_count": 2,
              "size": {
                "resource": "memory",
                "value": 15360 <a id="CO17-2"></a><i class="conum" data-value="2"></i>
              },
              "elasticsearch": {
                "enabled_built_in_plugins": []
              }
            }
          ],
          "elasticsearch": {
            "version": "7.4.2"
          },
          "deployment_template": {
            "id": "aws-io-optimized"
          }
        }
      }
    ]
  }
}
'</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Give the deployment a new name</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Increase the amount of memory allocated for each Elasticsearch node to 15 GB</p>
</td>
</tr>
</table>
</div>
<p>A 200 status code means that the configuration change was accepted.</p>
<h4><a id="ec_get_the_pending_plan_of_a_deployment"></a>Get the pending plan of a deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/saas/ec-restful-api.asciidoc">edit</a></h4>
<p>Get the pending plan of a deployment.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">curl \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/deployments/$DEPLOYMENT_ID/$RESOURCE_KIND/$REF_ID/plan/pending"</pre>
</div>
<p><code class="literal">DEPLOYMENT_ID</code>  The ID of the deployment returned in the response for <code class="literal">POST /deployments</code></p>
<p><code class="literal">RESOURCE_KIND</code>  Type of the deployment resource. It can be <code class="literal">elasticsearch</code>, <code class="literal">kibana</code>, <code class="literal">apm</code> or <code class="literal">appsearch</code></p>
<p><code class="literal">REF_ID</code>  Name given to each resource type in the attribute <code class="literal">ref_id</code>. <code class="literal">main-elasticsearch</code> in the above example</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="ec-api-examples.html">« API examples</a>
</span>
<span class="next">
<a href="ec-api-deployment-other.html">Other deployment operations »</a>
</span>
</div>
</div>
</body>
</html>
