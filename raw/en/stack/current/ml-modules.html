<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Playing with Asciidoctor to create Elastic Stack docs">
<meta name="keywords" content="Elasticsearch, Kibana, Logstash">
<title>Machine learning modules | Elastic Stack docs | Elastic</title>
<link rel="home" href="index.html" title="Elastic Stack docs"/>
<link rel="up" href="_reference.html" title="Reference"/>
<link rel="prev" href="ml-functions.html" title="Machine learning functions"/>
<link rel="next" href="ml-limitations.html" title="Machine learning limitations"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack"/>
<meta name="DC.subject" content="Elastic Stack"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Stack docs</a></span>
»
<span class="breadcrumb-link"><a href="_reference.html">Reference</a></span>
»
<span class="breadcrumb-node">Machine learning modules</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-functions.html">« Machine learning functions</a>
</span>
<span class="next">
<a href="ml-limitations.html">Machine learning limitations »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-modules"></a>Machine learning modules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/landing.asciidoc">edit</a></h2>
</div></div></div>
<p>Anomaly detection jobs contain the configuration information and metadata necessary
to perform an analytics task. Kibana can recognize certain types of data and
provide specialized wizards for that context. This page lists the categories of
the anomaly detection jobs that are ready to use via Kibana.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-apache" title="Apache anomaly detection configurations">Apache</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-apm" title="APM anomaly detection configurations">APM</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-auditbeat" title="Auditbeat anomaly detection configurations">Auditbeat</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-logs-ui" title="Logs anomaly detection configurations">Logs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-metricbeat" title="Metricbeat anomaly detection configurations">Metricbeat</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-nginx" title="Nginx anomaly detection configurations">Nginx</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-siem" title="SIEM anomaly detection configurations">SIEM</a>
</li>
<li class="listitem">
<a class="xref" href="ml-modules.html#ootb-ml-jobs-uptime" title="Uptime anomaly detection configurations">Uptime</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-apache"></a>Apache anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection job wizards appear in Kibana if you use
<a href="/guide/en/beats/filebeat/master/index.html" class="ulink" target="_top">Filebeat</a> to ship access logs from your
<a href="https://httpd.apache.org/" class="ulink" target="_top">Apache</a> HTTP servers to Elasticsearch and store it using fields
and data types from the Elastic Common Schema (ECS). For more details, see the
datafeed and job definitions in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/apache_ecs/ml" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
low_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests.
</li>
<li class="listitem">
Detects unusually low counts of HTTP requests compared to the previous event
rate (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
source_ip_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high request rates in the HTTP access log
compared to the previous rate (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
source_ip_url_count_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high distinct count of URLs in the HTTP
access log (using the <a class="xref" href="ml-functions.html#ml-distinct-count" title="Distinct_count, high_distinct_count, low_distinct_count"><code class="literal">high_distinct_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
status_code_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models the occurrences of HTTP response status codes (<code class="literal">partition_field_name</code>
is <code class="literal">http.response.status_code</code>).
</li>
<li class="listitem">
Detects unusual status code rates in the HTTP access log compared to previous
rates (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
visitor_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">apache.access</code>.
</li>
<li class="listitem">
Models visitor rates.
</li>
<li class="listitem">
Detects unusual visitor rates in the HTTP access log ompared to previous
rates (using the <a class="xref" href="ml-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-apm"></a>APM anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection job wizards appear in Kibana if you have data from APM Agents or
an APM Server stored in Elasticsearch. For more details, see the datafeed and job
definitions in the <code class="literal">apm_*</code> folders in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
abnormal_span_durations_jsbase
</span>
</dt>
<dt>
<span class="term">
abnormal_span_durations_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents or Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code> or <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the duration of spans (<code class="literal">partition_field_name</code> is <code class="literal">span.type</code>).
</li>
<li class="listitem">
Detects for spans that are taking longer than usual to process (using the
<a class="xref" href="ml-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
abnormal_trace_durations_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the duration of trace transactions.
</li>
<li class="listitem">
Detects trace transactions that are processing slower than usual (using the
<a class="xref" href="ml-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
anomalous_error_rate_for_user_agents_jsbase
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code>).
</li>
<li class="listitem">
Models the error rate of user agents (<code class="literal">partition_field_name</code> is
<code class="literal">user_agent.name</code>).
</li>
<li class="listitem">
Detects user agents that are encountering errors at an above normal rate
(using the <a class="xref" href="ml-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>This job can help detect browser compatibility issues.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
decreased_throughput_jsbase
</span>
</dt>
<dt>
<span class="term">
decreased_throughput_nodejs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents or Elastic APM Node.js Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code> or <code class="literal">nodejs</code>).
</li>
<li class="listitem">
Models the transaction rate of the application.
</li>
<li class="listitem">
Detects periods during which the application is processing fewer requests
than normal (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
high_count_by_user_agent_jsbase
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For data from Elastic APM RUM JavaScript Agents (where <code class="literal">agent.name</code> is <code class="literal">js-base</code>).
</li>
<li class="listitem">
Models the request rate of user agents (<code class="literal">partition_field_name</code> is
<code class="literal">user_agent.name</code>).
</li>
<li class="listitem">
Detects user agents that are making requests at a suspiciously high rate
(using the <a class="xref" href="ml-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>This job is useful in identifying bots.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_mean_response_time
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For transaction data where <code class="literal">processor.event</code> is <code class="literal">transaction</code> and
<code class="literal">transaction.type</code> is <code class="literal">request</code>.
</li>
<li class="listitem">
Models response time duration of transactions.
</li>
<li class="listitem">
Detects anomalies in high mean of transaction duration (using the
<a class="xref" href="ml-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-auditbeat"></a>Auditbeat anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection job wizards appear in Kibana if you use
<a href="/guide/en/beats/auditbeat/master/index.html" class="ulink" target="_top">Auditbeat</a> to audit process activity on your
systems. For more details, see the datafeed and job definitions in the
<code class="literal">auditbeat_*</code> folders in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
docker_high_count_process_events_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code> and <code class="literal">container.runtime</code> is
<code class="literal">docker</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">container.name</code>).
</li>
<li class="listitem">
Detects unusual increases in process execution rates in Docker containers
(using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
docker_rare_process_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code> and <code class="literal">container.runtime</code> is
<code class="literal">docker</code>.
</li>
<li class="listitem">
Models occurrences of process execution (<code class="literal">partition_field_name</code> is
<code class="literal">container.name</code>).
</li>
<li class="listitem">
Detects rare process executions in Docker containers (using the
<a class="xref" href="ml-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
hosts_high_count_process_events_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in process execution rates (using the
<a class="xref" href="ml-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
hosts_rare_process_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Auditbeat data where <code class="literal">event.module</code> is <code class="literal">auditd</code>.
</li>
<li class="listitem">
Models process execution rates (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects rare process executions on hosts (using the
<a class="xref" href="ml-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-logs-ui"></a>Logs anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection jobs appear by default in the
<a href="/guide/en/kibana/master/xpack-logs.html" class="ulink" target="_top">Logs app</a> in Kibana. For more details, see the
datafeed and job definitions in the <code class="literal">logs_ui_*</code> folders in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
log_entry_categories_count
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For log entry categories via the Logs UI.
</li>
<li class="listitem">
Models the occurrences of log events (<code class="literal">partition_field_name</code> is
<code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects anomalies in count of log entries by category (using the
<a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
log_entry_rate
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For log entries via the Logs UI.
</li>
<li class="listitem">
Models ingestion rates (<code class="literal">partition_field_name</code> is <code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects anomalies in the log entry ingestion rate (using the
<a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-metricbeat"></a>Metricbeat anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection job wizards appear in Kibana if you use the
<a href="/guide/en/beats/metricbeat/master/metricbeat-module-system.html" class="ulink" target="_top">Metricbeat system module</a> to
monitor your servers. For more details, see the
datafeed and job definitions in <a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/metricbeat_system_ecs/ml" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_mean_cpu_iowait_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models CPU time spent in iowait (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in cpu time spent in iowait (using the
<a class="xref" href="ml-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
max_disk_utilization_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models disc utilization (<code class="literal">partition_field_name</code> is <code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusual increases in disk utilization (using the
<a class="xref" href="ml-functions.html#ml-metric-max" title="Max"><code class="literal">max</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
metricbeat_outages_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Metricbeat data where <code class="literal">event.dataset</code> is <code class="literal">system.cpu</code> and
<code class="literal">system.filesystem</code>.
</li>
<li class="listitem">
Models counts of Metricbeat documents
(<code class="literal">partition_field_name</code> is <code class="literal">event.dataset</code>).
</li>
<li class="listitem">
Detects unusual decreases in Metricbeat documents (using the
<a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-nginx"></a>Nginx anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection job wizards appear in Kibana if you use Filebeat to ship access
logs from your <a href="http://nginx.org/" class="ulink" target="_top">Nginx</a> HTTP servers to Elasticsearch and store it using
fields and datatypes from the Elastic Common Schema (ECS). For more details, see
the datafeed and job definitions in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/nginx_ecs/ml" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
low_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of http requests.
</li>
<li class="listitem">
Detects unusually low counts of HTTP requests compared to the previous event
rate (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">low_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
source_ip_request_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high request rates in the HTTP access log
compared to the previous rate (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">high_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
source_ip_url_count_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the event rate of HTTP requests by source IP.
</li>
<li class="listitem">
Detects source IPs with unusually high distinct count of URLs in the HTTP
access log (using the <a class="xref" href="ml-functions.html#ml-distinct-count" title="Distinct_count, high_distinct_count, low_distinct_count"><code class="literal">high_distinct_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
status_code_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models the occurrences of HTTP response status codes (<code class="literal">partition_field_name</code>
is <code class="literal">http.response.status_code</code>).
</li>
<li class="listitem">
Detects unusual status code rates in the HTTP access log compared to previous
rates (using the <a class="xref" href="ml-functions.html#ml-count" title="Count, high_count, low_count"><code class="literal">count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
visitor_rate_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For HTTP web access logs where <code class="literal">event.dataset</code> is <code class="literal">nginx.access</code>.
</li>
<li class="listitem">
Models visitor rates.
</li>
<li class="listitem">
Detects unusual visitor rates in the HTTP access log ompared to previous
rates (using the <a class="xref" href="ml-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-siem"></a>SIEM anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>These anomaly detection jobs appear by default in the Anomaly Detection interface of
the <a href="/guide/en/siem/guide/master/machine-learning.html" class="ulink" target="_top">SIEM app</a> in Kibana. They help you
automatically detect file system and network anomalies on your hosts. However,
if you don&#8217;t use Beats, you need to map your data to the ECS fields that are
listed for every job.</p>
<p>For more details, see the
datafeed and job definitions in the <code class="literal">siem_*</code> folders in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_activity_ecs
</span>
</dt>
<dt>
<span class="term">
windows_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies OS processes that do not usually use the network but have
unexpected network activity, which can indicate command-and-control, lateral
movement, persistence, or data exfiltration activity.
</p>
<p>A process with unusual network activity can denote process exploitation or
injection, where the process is used to run persistence mechanisms that allow a
malicious actor remote access or control of the host, data exfiltration, and
execution of unauthorized network applications.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> (Linux) or <code class="literal">winlogbeat</code> (Windows).
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_port_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies unusual destination port activity that can indicate
command-and-control, persistence mechanism, or data exfiltration activity.
</p>
<p>Rarely used destination port activity is generally unusual in Linux fleets, and
can indicate unauthorized access or threat actor activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models destination port activity.
</li>
<li class="listitem">
Detects destination port activity that occurs rarely compared to other port
activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Auditbeat to ship data.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_service
</span>
</dt>
<dd>
<p>
Searches for unusual listening ports that can indicate execution of
unauthorized services, backdoors, or persistence mechanisms.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models listening port activity.
</li>
<li class="listitem">
Detects listening port activity that occurs rarely compared to
other port activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Auditbeat to ship data.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_url_activity_ecs
</span>
</dt>
<dd>
<p>
Searches for unusual web URL requests from hosts, which can indicate malware
delivery and execution.
</p>
<p>Wget and cURL are commonly used by Linux programs to download code and data.
Most of the time, their usage is entirely normal. Generally, because they use a
list of URLs, they repeatedly download from the same locations. However, Wget
and cURL are sometimes used to deliver Linux exploit payloads, and threat
actors use these tools to download additional software and code. For these
reasons, unusual URLs can indicate unauthorized downloads or threat activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of URL requests.
</li>
<li class="listitem">
Detects a web URL request that is rare compared to other web URL
requests (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">destination.port</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">process.title</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_process_all_hosts_ecs
</span>
</dt>
<dt>
<span class="term">
windows_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<p>
Searches for rare processes running on multiple hosts in an entire fleet or
network.
</p>
<p>This reduces the detection of false positives since automated maintenance
processes usually only run occasionally on a single machine but are common to
all or many hosts in a fleet.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> (Linux) or <code class="literal">winlogbeat</code> (Windows).
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes on all
hosts (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.executable</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_user_name_ecs
</span>
</dt>
<dt>
<span class="term">
windows_anomalous_user_name_ecs
</span>
</dt>
<dd>
<p>
Searches for activity from users who are not normally active, which can
indicate unauthorized changes, activity by unauthorized users, lateral
movement, and compromised credentials.
</p>
<p>In organizations, new usernames are not often created apart from specific types
of system activities, such as creating new accounts for new employees. These
user accounts quickly become active and routine.</p>
<p>Events from rarely used usernames can point to suspicious activity.
Additionally, automated Linux fleets tend to see activity from rarely used
usernames only when personnel log in to make authorized or unauthorized
changes, or threat actors have acquired credentials and log in for malicious
purposes. Unusual usernames can also indicate pivoting, where compromised
credentials are used to try and move laterally from one host to another.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> (Linux) or
<code class="literal">winlogbeat</code> (Windows).
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_dns_tunneling
</span>
</dt>
<dd>
<p>
Searches for unusually large numbers of DNS queries
for a single top-level DNS domain, which is often used for DNS tunneling.
</p>
<p>DNS tunneling can be used for command-and-control, persistence, or data
exfiltration activity. For example, <code class="literal">dnscat</code> tends to generate many DNS
questions for a top-level domain as it uses the DNS protocol to tunnel data.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects unusual DNS activity (using the
<a href="/guide/en/machine-learning/master/ml-info-functions.html#ml-info-content" class="ulink" target="_top"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">dns.question.registered_domain</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.name</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job uses the Packetbeat
<a href="/guide/en/beats/packetbeat/master/exported-fields-dns.html" class="ulink" target="_top"><code class="literal">dns.question.etld_plus_one</code></a> field,
which is not defined in ECS. Instead, map your network data to the
<a href="/guide/en/ecs/1.4/ecs-dns.html" class="ulink" target="_top"><code class="literal">dns.question.registered_domain</code></a> ECS field.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_dns_question
</span>
</dt>
<dd>
<p>
Searches for rare and unusual DNS queries that indicate network activity with
unusual domains is about to occur. This can be due to initial access,
persistence, command-and-control, or exfiltration activity.
</p>
<p>For example, when a user clicks on a link in a phishing email or opens a
malicious document, a request may be sent to download and run a payload from an
uncommon domain. When malware is already running, it may send requests to an
uncommon DNS domain the malware uses for command-and-control communication.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects DNS activity that is rare compared to other DNS activities (using the
<a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.type</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_server_domain
</span>
</dt>
<dd>
<p>
Searches for rare and unusual DNS queries that indicate network activity with
unusual domains is about to occur. This can be due to initial access,
persistence, command-and-control, or exfiltration activity.
</p>
<p>For example, when a user clicks on a link in a phishing email or opens a
malicious document, a request may be sent to download and run a payload from an
uncommon HTTP or TLS server. When malware is already running, it may send
requests to an uncommon DNS domain the malware uses for command-and-control
communication.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models HTTP or TLS domain activity.
</li>
<li class="listitem">
Detects HTTP or TLS domain activity that is rare compared to other
activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">server.domain</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_urls
</span>
</dt>
<dd>
<p>
Searches for rare and unusual URLs that indicate unusual
web browsing activity. This can be due to initial access, persistence,
command-and-control, or exfiltration activity.
</p>
<p>For example, in a strategic web compromise or watering hole attack, when a
trusted website is compromised to target a particular sector or organization,
targeted users may receive emails with uncommon URLs for trusted websites. These
URLs can be used to download and run a payload. When malware is already running,
it may send requests to uncommon URLs on trusted websites the malware uses for
command-and-control communication. When rare URLs are observed being requested
for a local web server by a remote source, these can be due to web scanning,
enumeration or attack traffic, or they can be due to bots and web scrapers which
are part of common Internet background traffic.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of web browsing URL activity.
</li>
<li class="listitem">
Detects URL activity that rarely occurs compared to other URL activities
(using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">url.full</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_user_agent
</span>
</dt>
<dd>
<p>
Searches for rare and unusual user agents that indicate web browsing activity
by an unusual process other than a web browser. This can be due to persistence,
command-and-control, or exfiltration activity. Uncommon user agents coming from
remote sources to local destinations are often the result of scanners, bots,
and web scrapers, which are part of common internet background traffic.
</p>
<p>Much of this is noise, but more targeted attacks on websites using tools like
Burp or SQLmap can sometimes be discovered by spotting uncommon user agents.
Uncommon user agents in traffic from local sources to remote destinations can
be any number of things, including harmless programs like weather monitoring or
stock-trading programs. However, uncommon user agents from local sources can
also be due to malware or scanning activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of HTTP user agent activity.
</li>
<li class="listitem">
Detects HTTP user agent activity that occurs rarely compared to other HTTP
user agent activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">user_agent.original</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_process_by_host_linux_ecs
</span>
</dt>
<dt>
<span class="term">
rare_process_by_host_windows_ecs
</span>
</dt>
<dd>
<p>
Identifies rare processes that do not usually run on individual hosts, which
can indicate execution of unauthorized services, malware, or persistence
mechanisms.
</p>
<p>Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code> (Windows) or <code class="literal">auditbeat</code> (Linux).
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detects unusually rare processes compared to other processes on the host (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
suspicious_login_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies an unusually high number of authentication attempts.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of authentication attempts (<code class="literal">partition_field_name</code> is
<code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusually high number of authentication attempts (using the
<a href="/guide/en/machine-learning/master/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_path_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies processes started from atypical folders in the file system, which
might indicate malware execution or persistence mechanisms.
</p>
<p>In corporate Windows environments, software installation is centrally managed
and it is unusual for programs to be executed from user or temporary
directories. Processes executed from these locations can denote that a user
downloaded software directly from the internet or a malicious script/macro
executed malware.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of processes in paths.
</li>
<li class="listitem">
Detects activity in unusual paths (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.working_directory</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_process_creation
</span>
</dt>
<dd>
<p>
Identifies unusual parent-child process relationships that can indicate
malware execution or persistence mechanisms.
</p>
<p>Malicious scripts often call on other applications and processes as part of
their exploit payload. For example, when a malicious Office document runs
scripts as part of an exploit payload, Excel or Word may start a script
interpreter process, which, in turn, runs a script that downloads and executes
malware. Another common scenario is Outlook running an unusual process when
malware is downloaded in an email.</p>
<p>Monitoring and identifying anomalous process relationships is an excellent way
of detecting new and emerging malware that is not yet recognized by anti-virus
scanners.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process creation activities (<code class="literal">partition_field_name</code> is
<code class="literal">process.parent.name</code>).
</li>
<li class="listitem">
Detects process relationships that are rare compared to other process
relationships (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.parent.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_script
</span>
</dt>
<dd>
<p>
Searches for PowerShell scripts with unusual data characteristics, such as
obfuscation, that may be a characteristic of malicious PowerShell script text
blocks.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of PowerShell script activities.
</li>
<li class="listitem">
Detects unusual PowerShell script execution compared to other PowerShell
script activities (using the
<a href="/guide/en/machine-learning/master/ml-info-functions.html#ml-info-content" class="ulink" target="_top"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_service
</span>
</dt>
<dd>
<p>
Searches for unusual Windows services that can indicate execution of
unauthorized services, malware, or persistence mechanisms.
</p>
<p>In corporate Windows environments, hosts do not generally run many rare or
unique services. This job helps detect malware and persistence mechanisms that
have been installed and run as a service.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of Windows service activities.
</li>
<li class="listitem">
Detects Windows service activities that occur rarely compared to other Windows service activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
windows_rare_user_runas_event
</span>
</dt>
<dd>
<p>
Searches for unusual user context switches using the <code class="literal">runas</code> command or similar
techniques, which can indicate account takeover or privilege escalation using
compromised accounts. Privilege elevation using tools like <code class="literal">runas</code> is more
common for domain and network administrators than professionals who are not
members of the technology department.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user context switches.
</li>
<li class="listitem">
Detects user context switches that occur rarely compared to other user context switches (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.code</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_rare_user_type10_remote_login
</span>
</dt>
<dd>
<p>
Searches for unusual remote desktop protocol (RDP) logins, which can indicate
account takeover or credentialed persistence using compromised accounts. RDP
attacks, such as BlueKeep, also tend to use unusual usernames.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user remote login activities.
</li>
<li class="listitem">
Detects user remote login activities that occur rarely compared to other
user remote login activities (using the <a href="/guide/en/machine-learning/master/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ootb-ml-jobs-uptime"></a>Uptime anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/master/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h3>
</div></div></div>

<p>If you have appropriate Heartbeat data in Elasticsearch, you can enable this
anomaly detection job in the
<a href="/guide/en/uptime/master/uptime-overview.html" class="ulink" target="_top">Elastic Uptime</a> app in Kibana. For more
details, see the datafeed and job definitions in
<a href="https://github.com/elastic/kibana/tree/master/x-pack/plugins/ml/server/models/data_recognizer/modules/uptime_heartbeat/ml" class="ulink" target="_top">GitHub</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_latency_by_geo
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects unusually high average latency values (using the
<a class="xref" href="ml-functions.html#ml-metric-mean" title="Mean, high_mean, low_mean"><code class="literal">high_mean</code> function</a> on the <code class="literal">monitor.duration.us</code> field).
</li>
<li class="listitem">
Models the occurrences across geographical locations (<code class="literal">partition_field_name</code>
is <code class="literal">observer.geo.name</code>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-functions.html">« Machine learning functions</a>
</span>
<span class="next">
<a href="ml-limitations.html">Machine learning limitations »</a>
</span>
</div>
</div>
</body>
</html>
