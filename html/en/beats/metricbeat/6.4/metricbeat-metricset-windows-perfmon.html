<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Windows perfmon metricset
        | Metricbeat Reference [6.4]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Metricbeat Reference [6.4]" /><link rel="up" href="metricbeat-module-windows.html" title="Windows module" /><link rel="prev" href="metricbeat-module-windows.html" title="Windows module" /><link rel="next" href="metricbeat-metricset-windows-service.html" title="Windows service metricset" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/6.4" /><meta name="DC.subject" content="Metricbeat" /><meta name="DC.identifier" content="6.4" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference
      [6.4]
    </a></span> » <span class="breadcrumb-link"><a href="metricbeat-modules.html">Modules</a></span> » <span class="breadcrumb-link"><a href="metricbeat-module-windows.html">Windows module</a></span> » <span class="breadcrumb-node">Windows perfmon metricset</span></div><div class="navheader"><span class="prev"><a href="metricbeat-module-windows.html">
              « 
              Windows module</a>
           
        </span><span class="next">
           
          <a href="metricbeat-metricset-windows-service.html">Windows service metricset
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="metricbeat-metricset-windows-perfmon"></a>Windows perfmon metricset<a href="https://github.com/elastic/beats/edit/6.4/metricbeat/docs/modules/windows/perfmon.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p></div></div><p>The <code class="literal">perfmon</code> metricset of the Windows module reads Windows performance
counters.</p><h3><a id="_configuration_14"></a>Configuration<a href="https://github.com/elastic/beats/edit/6.4/metricbeat/module/windows/perfmon/_meta/docs.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You must configure queries for the Windows performance counters that you wish
to collect. The example below collects processor time and disk writes every
10 seconds. If either of the counters do not exist it will ignore the error.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">- module: windows
  metricsets: [perfmon]
  period: 10s
  perfmon.ignore_non_existent_counters: true
  perfmon.counters:
    - instance_label: processor.name
      instance_name: total
      measurement_label: processor.time.total.pct
      query: '\Processor Information(_Total)\% Processor Time'

    - instance_label: physical_disk.name
      measurement_label: physical_disk.write.per_sec
      query: '\PhysicalDisk(*)\Disk Writes/sec'

    - instance_label: physical_disk.name
      measurement_label: physical_disk.write.time.pct
      query: '\PhysicalDisk(*)\% Disk Write Time'</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="strong strong"><strong><code class="literal">ignore_non_existent_counters</code></strong></span>
</span></dt><dd>
A boolean option that causes the
metricset to ignore errors caused by counters that do not exist when set to
true. Instead of an error, a message will be logged at the info level stating
that the counter does not exist.
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">counters</code></strong></span>
</span></dt><dd>
Counters specifies a list of queries to perform. Each individual
counter requires three config options - <code class="literal">instance_label</code>, <code class="literal">measurement_label</code>,
and <code class="literal">query</code>.
</dd></dl></div><h4><a id="_counter_configuration"></a>Counter Configuration<a href="https://github.com/elastic/beats/edit/6.4/metricbeat/module/windows/perfmon/_meta/docs.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Each item in the <code class="literal">counters</code> list specifies a perfmon query to perform. In the
events generated by the metricset these configuration options map to the field
values as shown below.</p><pre class="screen">"%[instance_label]": "%[instance_name] or &lt;perfmon_counter_name&gt;",
"%[measurement_label]": &lt;perfmon_counter_value&gt;,</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="strong strong"><strong><code class="literal">instance_label</code></strong></span>
</span></dt><dd>
The label used to identify the counter instance. This
field is required.
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">instance_name</code></strong></span>
</span></dt><dd><p class="simpara">
The instance name to use in the event when the counter’s
path (<code class="literal">query</code>) does not include an instance or when you want to override the
instance name. For example with <code class="literal">\Processor Information(_Total)</code> the
instance name would be <code class="literal">_Total</code> and by setting <code class="literal">instance_name: total</code> you can
override the value.
</p><p class="simpara">The setting has no effect with wildcard queries (e.g.
<code class="literal">\PhysicalDisk(*)\Disk Writes/sec</code>).</p></dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">measurement_label</code></strong></span>
</span></dt><dd>
The label used for the value returned by the query.
This field is required.
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">query</code></strong></span>
</span></dt><dd>
The perfmon query. This is the counter path specified in
Performance Data Helper (PDH) syntax. This field is required. For example
<code class="literal">\Processor Information(_Total)\% Processor Time</code>. An asterisk can be used in
place of an instance name to perform a wildcard query that generates an event
for each counter instance (e.g. <code class="literal">\PhysicalDisk(*)\Disk Writes/sec</code>).
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">format</code></strong></span>
</span></dt><dd>
Format of the measurement value. The value can be either <code class="literal">float</code> or
<code class="literal">long</code>. The default is <code class="literal">float</code>.
</dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_fields_102"></a>Fields<a href="https://github.com/elastic/beats/edit/6.4/metricbeat/docs/modules/windows/perfmon.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>For a description of each field in the metricset, see the
<a class="link" href="exported-fields-windows.html" title="Windows fields">exported fields</a> section.</p><p>Here is an example document generated by this metricset:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2017-10-12T08:05:34.853Z",
    "beat": {
        "hostname": "host.example.com",
        "name": "host.example.com"
    },
    "metricset": {
        "module": "windows",
        "name": "perfmon",
        "rtt": 115
    },
    "windows": {
        "perfmon": {
            "processor": {
                "name": "_Total",
                "time": {
                    "total": {
                        "pct": 1.4663385364361736
                    }
                }
            }
        }
    }
}</pre></div></div></div><div class="navfooter"><span class="prev"><a href="metricbeat-module-windows.html">
              « 
              Windows module</a>
           
        </span><span class="next">
           
          <a href="metricbeat-metricset-windows-service.html">Windows service metricset
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
