<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Set up flows to monitor network traffic
        | Packetbeat Reference [7.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Packetbeat Reference [7.3]" /><link rel="up" href="configuring-howto-packetbeat.html" title="Configuring Packetbeat" /><link rel="prev" href="configuration-interfaces.html" title="Set traffic capturing options" /><link rel="next" href="configuration-protocols.html" title="Specify which transaction protocols to monitor" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Packetbeat/Reference/7.3" /><meta name="DC.subject" content="Packetbeat" /><meta name="DC.identifier" content="7.3" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Packetbeat Reference
      [7.3]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span> » <span class="breadcrumb-node">Set up flows to monitor network traffic</span></div><div class="navheader"><span class="prev"><a href="configuration-interfaces.html">
              « 
              Set traffic capturing options</a>
           
        </span><span class="next">
           
          <a href="configuration-protocols.html">Specify which transaction protocols to monitor
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-flows"></a>Set up flows to monitor network traffic<a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>You can configure Packetbeat to collect and report statistics on network flows.
A <span class="emphasis"><em>flow</em></span> is a group of packets sent over the same time period that share
common properties, such as the same source and destination address and protocol.
You can use this feature to analyze network traffic over specific protocols on
your network.</p><p>For each flow, Packetbeat reports the number of packets and the total number of
bytes sent from the source to the destination. Each flow event also contains
information about the source and destination hosts, such as their IP address.
For bi-directional flows, Packetbeat reports statistics for the reverse flow.</p><p>Packetbeat collects and reports statistics up to and including the transport
layer. See <a class="xref" href="exported-fields-flows_event.html" title="Flow Event fields"><em>Flow Event fields</em></a> for more info about the exported
data.</p><p>Here’s an example of flow events visualized in the Flows dashboard:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/flows.png" alt="./images/flows.png" /></div></div><p>To configure flows, use the <code class="literal">packetbeat.flows</code> option in the <code class="literal">packetbeat.yml</code>
config file. Flows are enabled by default. If this section is missing
from the configuration file, network flows are disabled.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">packetbeat.flows:
  timeout: 30s
  period: 10s</pre></div><p>Here’s an example of a flow information sent by Packetbeat. See
<a class="xref" href="exported-fields-flows_event.html" title="Flow Event fields"><em>Flow Event fields</em></a> for a description of each field.</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">{
  "@timestamp": "2018-11-15T14:41:24.000Z",
  "agent": {
    "hostname": "host.example.com",
    "name": "host.example.com",
    "version": "7.3.2"
  },
  "destination": {
    "bytes": 460,
    "ip": "198.51.100.2",
    "mac": "06:05:04:03:02:01",
    "packets": 2,
    "port": 80
  },
  "event": {
    "dataset": "flow",
    "duration": 3000000000,
    "end": "2018-11-15T14:41:24.000Z",
    "start": "2018-11-15T14:41:21.000Z"
  },
  "flow": {
    "final": true, <a id="CO7-1"></a><i class="conum" data-value="1"></i>
    "id": "FQQA/wz/Dv//////Fv8BAQEBAgMEBQYGBQQDAgGrAMsAcQPGM2QC9ZdQAA",
    "vlan": 171
  },
  "network": {
    "bytes": 470,
    "community_id": "1:t9T66/2c66NQyftAEsr4aMZv4Hc=",
    "packets": 3,
    "transport": "tcp",
    "type": "ipv4"
  },
  "source": {
    "bytes": 10,
    "ip": "203.0.113.3",
    "mac": "01:02:03:04:05:06",
    "packets": 1,
    "port": 38901
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO7-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
Packetbeat sets the <code class="literal">flow.final</code> flag to <code class="literal">false</code> to indicate that the event
contains an intermediate report about a flow that it’s tracking. When the flow
completes, Packetbeat sends one last event with <code class="literal">flow.final</code> set to <code class="literal">true</code>. If
you want to aggregate sums of traffic, you need to filter on <code class="literal">final:true</code>, or
use some other technique, so that you get only the latest update from each flow.
You can disable intermediate reports by setting <code class="literal">period: -1s</code>.
</p></td></tr></table></div><h3><a id="_configuration_options"></a>Configuration options<a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can specify the following options in the <code class="literal">packetbeat.flows</code> section of
the <code class="literal">packetbeat.yml</code> config file:</p><h4><a id="_literal_enabled_literal"></a><code class="literal">enabled</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Enables flows support if set to true. Set to false to disable network flows
support without having to delete or comment out the flows section. The default
value is true.</p><h4><a id="_literal_timeout_literal"></a><code class="literal">timeout</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Timeout configures the lifetime of a flow. If no packets have been received for
a flow within the timeout time window, the flow is killed and reported. The
default value is 30s.</p><h4><a id="_literal_period_literal"></a><code class="literal">period</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Configure the reporting interval. All flows are reported at the very same point
in time. Periodical reporting can be disabled by setting the value to -1. If
disabled, flows are still reported once being timed out. The default value is
10s.</p><h4><a id="packetbeat-configuration-flows-fields"></a><code class="literal">fields</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p><h4><a id="_literal_fields_under_root_literal"></a><code class="literal">fields_under_root</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is set to true, the custom <a class="link" href="configuration-flows.html#packetbeat-configuration-flows-fields" title="fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Packetbeat, then the custom fields overwrite the other
fields.</p><h4><a id="_literal_tags_literal"></a><code class="literal">tags</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of tags that will be sent with the protocol event. This setting is optional.</p><h4><a id="_literal_processors_literal"></a><code class="literal">processors</code><a href="https://github.com/elastic/beats/edit/7.3/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of processors to apply to the data generated by the protocol.</p><p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance the exported data"><em>Filter and enhance the exported data</em></a> for information about specifying
processors in your config.</p></div><div class="navfooter"><span class="prev"><a href="configuration-interfaces.html">
              « 
              Set traffic capturing options</a>
           
        </span><span class="next">
           
          <a href="configuration-protocols.html">Specify which transaction protocols to monitor
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
